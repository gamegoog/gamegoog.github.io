function loginUser(){var e=$("#loginForm");e.find(":input").each((function(){var e=$(this);e.val(e.val().trim())})),e.valid()&&postUserLogin(e)}function loginOnEnterKey(e){e&&13==e.keyCode&&loginUser()}function logOutUser(){var e=$.post(LOGIN_POST_PATH,{action:"logout"});e.fail((function(){alert("There was an unexpected error logging out.")})),e.done((function(){window.location.reload(!0)}))}function postUserLogin(e){setLoginButtonState(!1);var n=$.post(LOGIN_POST_PATH,e.serialize());n.fail((function(){showLoginErrorMsg("Login Failed. System Error. Please try again later.")})),n.done((function(e){var n=e.split(":"),o=n[0],i=n[1];"success"==o&&"true"==i?window.location.reload(!0):"failure"==o&&"userpass"==i?showLoginErrorMsg("Login failed. No matching email and password."):"lockout"==o?showLoginErrorMsg("Too many failed logins. Please wait "+(i=i>1?i+" minutes.":i+" minute.")):alert("System Error. Please try again later.")}))}function initValidateLogin(){$("#loginForm").validate({onkeyup:!1,invalidHandler:function(e,n){n.numberOfInvalids()&&showLoginErrorMsg(n.errorList[0].message)},errorPlacement:function(e){},rules:{login_user_email:{required:!0,minlength:6,email:!0},login_user_pass:{required:!0}},messages:{login_user_email:{required:"Please enter an email address.",minlength:"Enter an email at least six characters."},login_user_pass:{required:"Please enter your password."}}})}function setLoginButtonState(e){var n=$("#login_btn");e?(n.prop("disabled",!1),n.fadeTo(1,1)):(n.prop("disabled",!0),n.fadeTo(1,.5))}function showLoginErrorMsg(e){$("#login_error_msg").html(e).fadeOut(0).fadeIn(400,(function(){$("#problems_button").delay(1700).slideDown(400),$("#login_error_msg").delay(1700).fadeOut(400,(function(){setLoginButtonState(!0)}))}))}$(document).ready((function(){initValidateLogin(),setLoginButtonState(!0)}));var LOGIN_POST_PATH="/user.hw";